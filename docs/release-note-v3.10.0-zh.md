# CC Switch v3.10.0

> OpenCode 支持、全局代理、Claude Rectifier 与多应用体验增强

**[English →](release-note-v3.10.0-en.md) | [日本語版 →](release-note-v3.10.0-ja.md)**

---

## 概览

CC Switch v3.10.0 新增 OpenCode 支持，成为第四个受管理的 CLI 应用。
同时带来全局代理设置、Claude Rectifier（thinking 签名修正器）、健康检查增强、按供应商配置等多项重要功能，并对多应用工作流与终端体验做了全面改进。

**发布日期**：2026-01-21

---

## 重点内容

- OpenCode 支持：供应商、MCP 服务器、Skills 全面管理，首次启动自动导入
- 全局代理：为出站网络请求统一配置代理
- Claude Rectifier：thinking 签名修正器，兼容更多第三方 API
- 健康检查增强：可配置提示词、CLI 兼容请求
- 按供应商配置：支持供应商特定配置的持久化
- 应用可见性控制：自由显示/隐藏应用，托盘菜单同步更新
- 终端改进：供应商专属终端按钮、fnm 路径支持、跨平台安全启动
- WSL 工具检测：在 WSL 环境检测工具版本，并增加安全加固

---

## 主要功能

### OpenCode 支持（新增第四应用）

- 完整的 OpenCode 供应商管理：新增、编辑、切换、删除
- MCP 服务器管理：与 Claude/Codex/Gemini 统一架构
- Skills 支持：OpenCode 也可使用 Skills 功能
- 首次启动自动导入：检测到已有 OpenCode 配置时自动导入
- 完整国际化：中/英/日三语支持（#695）

### 全局代理（Global Proxy）

- 为所有出站网络请求配置统一代理（#596，感谢 @yovinchen）
- 支持 HTTP/HTTPS 代理协议
- 适用于需要代理访问外部 API 的网络环境

### Claude Rectifier（Thinking 签名修正器）

- 自动修正 Claude API 的 thinking 签名（#595，感谢 @yovinchen）
- 解决部分第三方 API 网关返回的 thinking 块格式不兼容问题
- 在高级设置中可开启/关闭

### 健康检查增强

- 可配置自定义提示词（prompt）用于流式健康检查（#623，感谢 @yovinchen）
- 支持 CLI 兼容请求格式，更好地模拟真实使用场景
- 提升故障检测的准确性

### 按供应商配置（Per-Provider Config）

- 支持为每个供应商单独保存配置（#663，感谢 @yovinchen）
- 配置持久化：重启后保留供应商专属设置
- 适用于不同供应商需要不同配置的场景

### 应用可见性控制

- 自由显示/隐藏任意应用（Gemini 默认隐藏）
- 托盘菜单自动同步可见性设置
- 隐藏的应用不会出现在主界面和托盘菜单中

### Takeover Compact Mode

- 当显示 3 个及以上可见应用时，自动使用紧凑布局
- 优化多应用场景下的空间利用

### 终端改进

- 供应商专属终端按钮：一键在终端中使用当前供应商（#564，感谢 @kkkman22）
- `fnm` 路径支持：自动识别 fnm 管理的 Node.js 路径
- 跨平台安全启动：改进 Windows/macOS/Linux 的终端启动逻辑

### WSL 工具检测

- 在 WSL 环境中检测工具版本（#627，感谢 @yovinchen）
- 增加安全加固，防止命令注入风险

### Skills 预设增强

- 新增 `baoyu-skills` 预设仓库
- 自动补充缺失的默认仓库，确保开箱即用

---

## 体验优化

- 键盘快捷键：按 `ESC` 快速返回/关闭面板（#670，感谢 @xxk8）
- 代理日志简化：输出更清晰易读（#585，感谢 @yovinchen）
- 定价编辑器 UX：统一使用 `FullScreenPanel` 风格
- 高级设置布局：Rectifier 区块移至 Failover 下方，逻辑更顺畅
- OpenRouter 兼容模式：默认禁用，UI 开关隐藏（减少干扰）

---

## Bug 修复

### 代理与故障切换

- 启用自动故障切换时立即切换到 P1（而非等待下次请求）

### 供应商管理

- 修复供应商编辑对话框保存后重新打开时数据过时的问题（#654，感谢 @YangYongAn）
- 修复切换预设时 baseUrl 和 apiKey 状态未重置的问题
- 修复端点自动选择状态未持久化的问题（#611，感谢 @yovinchen）
- 未设置图标颜色时自动应用默认颜色

### 深链接

- 支持多端点导入（#597，感谢 @yovinchen）
- 优先使用 `GOOGLE_GEMINI_BASE_URL` 而非 `GEMINI_BASE_URL`

### MCP

- WSL 目标路径跳过 `cmd /c` 包裹（#592，感谢 @cxyfer）

### 用量模板

- 新增变量提示，修复验证问题（#628，感谢 @YangYongAn）
- 防止配置在供应商之间泄漏
- 用量区块偏移量根据操作按钮宽度自动适应（#613，感谢 @yovinchen）

### Gemini

- 超时参数转换为 Gemini CLI 格式（#580，感谢 @cxyfer）

### UI

- 修复 `FullScreenPanel` 中 Select 下拉框渲染问题

---

## 说明与注意事项

- **OpenCode 为新支持的应用**：需要先安装 OpenCode CLI 才能使用相关功能。
- **全局代理会影响所有出站请求**：包括用量查询、健康检查等网络操作。
- **Rectifier 功能为实验性**：如遇问题可在高级设置中关闭。

---

## 特别感谢

感谢 @yovinchen @YangYongAn @cxyfer @xxk8 @kkkman22 @Shuimo03 为本版本做出的贡献！
感谢 @libukai 设计的故障转移相关 UI，非常优雅！

---

## 下载与安装

访问 [Releases](https://github.com/farion1231/cc-switch/releases/latest) 下载对应版本。

### 系统要求

| 系统    | 最低版本                      | 架构                                |
| ------- | ----------------------------- | ----------------------------------- |
| Windows | Windows 10 及以上             | x64                                 |
| macOS   | macOS 10.15 (Catalina) 及以上 | Intel (x64) / Apple Silicon (arm64) |
| Linux   | 见下表                        | x64                                 |

### Windows

| 文件                                     | 说明                                |
| ---------------------------------------- | ----------------------------------- |
| `CC-Switch-v3.10.0-Windows.msi`          | **推荐** - MSI 安装包，支持自动更新 |
| `CC-Switch-v3.10.0-Windows-Portable.zip` | 便携版，解压即用，不写入注册表      |

### macOS

| 文件                             | 说明                                                      |
| -------------------------------- | --------------------------------------------------------- |
| `CC-Switch-v3.10.0-macOS.zip`    | **推荐** - 解压后拖入 Applications 即可，Universal Binary |
| `CC-Switch-v3.10.0-macOS.tar.gz` | 用于 Homebrew 安装和自动更新                              |

> **注意**：由于作者没有苹果开发者账号，首次打开可能出现"未知开发者"警告，请先关闭，然后前往"系统设置" → "隐私与安全性" → 点击"仍要打开"，之后便可以正常打开

### Homebrew（macOS）

```bash
brew tap farion1231/ccswitch
brew install --cask cc-switch
```

更新：

```bash
brew upgrade --cask cc-switch
```

### Linux

| 发行版                                  | 推荐格式    | 安装方式                                                               |
| --------------------------------------- | ----------- | ---------------------------------------------------------------------- |
| Ubuntu / Debian / Linux Mint / Pop!\_OS | `.deb`      | `sudo dpkg -i CC-Switch-*.deb` 或 `sudo apt install ./CC-Switch-*.deb` |
| Fedora / RHEL / CentOS / Rocky Linux    | `.rpm`      | `sudo rpm -i CC-Switch-*.rpm` 或 `sudo dnf install ./CC-Switch-*.rpm`  |
| openSUSE                                | `.rpm`      | `sudo zypper install ./CC-Switch-*.rpm`                                |
| Arch Linux / Manjaro                    | `.AppImage` | 添加执行权限后直接运行，或使用 AUR                                     |
| 其他发行版 / 不确定                     | `.AppImage` | `chmod +x CC-Switch-*.AppImage && ./CC-Switch-*.AppImage`              |
